import tkinter as tk
from tkinter import messagebox


class TicTacToe:
    def __init__(self):
        # –°–æ–∑–¥–∞—ë–º –æ–∫–Ω–æ
        self.root = tk.Tk()
        self.root.title("–ö—Ä–µ—Å—Ç–∏–∫–∏ –Ω–æ–ª–∏–∫–∏")
        # self.root.geometry("400x400")  # –û—Ç–∫–ª—é—á–∞–µ–º —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä
        self.root.iconbitmap("icon1.ico")  # —Å–æ–∑–¥–∞–µ—Ç –∏–∫–æ–Ω–∫—É
        self.current_player = "X"  # –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ö–æ–¥–∞, –ø–µ—Ä–≤—ã–º —Ö–æ–¥–∏—Ç "X" (–∫—Ä–µ—Å—Ç–∏–∫)
        self.buttons = []  # –°—é–¥–∞ –±—É–¥–µ–º —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –≤—Å–µ –∫–Ω–æ–ø–∫–∏

        # –ü—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏. –ü—Ä–∏–Ω—Ü–∏–ø –∏–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏–∏: –æ–±—ä–µ–∫—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è.
        # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∫–ª–∞—Å—Å–∞ (–∏–ª–∏ —Ç—ã —Å–∞–º –∑–∞–≤—Ç—Ä–∞) –Ω–µ –¥–æ–ª–∂–µ–Ω –ø–æ–º–Ω–∏—Ç—å, —á—Ç–æ –Ω—É–∂–Ω–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –≤—ã–∑—ã–≤–∞—Ç—å create_widgets().
        # –¢–∞–∫ –æ–±—ä–µ–∫—Ç –±—É–¥–µ—Ç –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è.
        self.create_widgets()

    def check_winner(self):
        """–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–±–µ–¥–∏—Ç–µ–ª—è."""
        winning_combinations = [
            [0, 1, 2], [3, 4, 5], [6, 7, 8],  # –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–µ –ª–∏–Ω–∏–∏
            [0, 3, 6], [1, 4, 7], [2, 5, 8],  # –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ –ª–∏–Ω–∏–∏
            [0, 4, 8], [2, 4, 6]              # –î–∏–∞–≥–æ–Ω–∞–ª—å–Ω—ã–µ –ª–∏–Ω–∏–∏
        ]
        for combo in winning_combinations:
            a, b, c = combo
            if self.buttons[a]["text"] == self.buttons[b]["text"] == self.buttons[c]["text"] != "":
                # –ó–∞–∫—Ä–∞—à–∏–≤–∞–µ–º –ø–æ–±–µ–¥–Ω—É—é –ª–∏–Ω–∏—é
                self.buttons[a].config(bg="lightgreen")
                self.buttons[b].config(bg="lightgreen")
                self.buttons[c].config(bg="lightgreen")
                return True
        return False

    def on_click(self, index):
        """–§—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–ª–∏–∫–∞, –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —Ö–æ–¥ –∏–≥—Ä–æ–∫–∞. 
            –û–Ω–∞ –ø–æ–ª—É—á–∞–µ—Ç –Ω–∞ –≤—Ö–æ–¥ –Ω–æ–º–µ—Ä –∫–Ω–æ–ø–∫–∏ index, –∫–æ—Ç–æ—Ä—É—é –Ω–∞–∂–∞–ª–∏, –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ç—Ä–∏ –≤–∞–∂–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏—è:
            –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —Å–≤–æ–±–æ–¥–Ω–∞ –ª–∏ –∫–ª–µ—Ç–∫–∞.
            –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç —Å–∏–º–≤–æ–ª —Ç–µ–∫—É—â–µ–≥–æ –∏–≥—Ä–æ–∫–∞ ("X" –∏–ª–∏ "O") –≤ —Ç–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏.
            –ü–µ—Ä–µ–¥–∞—ë—Ç —Ö–æ–¥ –¥—Ä—É–≥–æ–º—É –∏–≥—Ä–æ–∫—É."""
        # global current_player  # –ò—Å–ø–æ–ª—å–∑—É–µ–º –≥–ª–æ–±–∞–ª—å–Ω—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é(–£–¥–∞–ª–µ–Ω–æ ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è self.current_player)!!!

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –ø—É—Å—Ç–∞—è –ª–∏ –∫–Ω–æ–ø–∫–∞
        if self.buttons[index]["text"] == "":
            # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º X –∏–ª–∏ O
            self.buttons[index]["text"] = self.current_player

            # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –ø–æ–±–µ–¥–∏—Ç–µ–ª—å
            if self.check_winner():
                # –í—Ä–µ–º–µ–Ω–Ω—ã–π –≤—ã–≤–æ–¥ –≤ –∫–æ–Ω—Å–æ–ª—å(–ø–æ–∑–∂–µ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ –≤—Å–ø–ª—ã–≤–∞—é—â–µ–µ –æ–∫–Ω–æ.)
                # –í—Å–ø–ª—ã–≤–∞—é—â–µ–µ –æ–∫–Ω–æ —Å –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–º
                messagebox.showinfo(
                    "–ü–æ–±–µ–¥–∞!", f"–ü–æ–±–µ–¥–∏–ª {self.current_player}!")
            elif all(button["text"] != "" for button in self.buttons):  # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∏—á—å—é
                # –í—Å–ø–ª—ã–≤–∞—é—â–µ–µ –æ–∫–Ω–æ —Å –Ω–∏—á—å–µ–π
                messagebox.showinfo("–ù–∏—á—å—è!", "–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞. –ù–∏—á—å—è!")

            # –ú–µ–Ω—è–µ–º –∏–≥—Ä–æ–∫–∞
            if self.current_player == "X":
                self.current_player = "O"
            else:
                self.current_player = "X"

    def reset_game(self):
        """–§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–±—Ä–æ—Å–∞ –∏–≥—Ä—ã. –ë—É–¥–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å—Å—è –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É "–ù–æ–≤–∞—è –∏–≥—Ä–∞"."""
        # global current_player(—ç—Ç–æ —Ç–æ–∂–µ —Å–∞–º–æ–µ, –≤–æ–æ–±—â–µ –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ —É–¥–∞–ª–∏—Ç—å)!!!
        self.current_player = "X"  # –ü–µ—Ä–≤—ã–π —Ö–æ–¥ –≤—Å–µ–≥–¥–∞ –∑–∞ "X"

        # –û—á–∏—â–∞–µ–º –≤—Å–µ –∫–Ω–æ–ø–∫–∏, –≤–æ–∑–≤—Ä–∞—â–∞—è –∏–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ü–≤–µ—Ç –∏ —É–±–∏—Ä–∞—è —Ç–µ–∫—Å—Ç
        for button in self.buttons:
            button.config(text="", bg="SystemButtonFace")

    def create_widgets(self):
        """–°–æ–∑–¥–∞—ë—Ç –∏–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ –∏–∑ 9 –∫–Ω–æ–ø–æ–∫."""
        for i in range(9):  # –°–æ–∑–¥–∞—ë–º 9 –∫–Ω–æ–ø–æ–∫ (–æ—Ç 0 –¥–æ 8)
            button = tk.Button(
                self.root,
                text="",  # –ü–æ–∫–∞ –±–µ–∑ —Ç–µ–∫—Å—Ç–∞
                font=("Arial", 30),  # –ö—Ä—É–ø–Ω—ã–π —à—Ä–∏—Ñ—Ç
                width=5,  # –®–∏—Ä–∏–Ω–∞ –∫–Ω–æ–ø–∫–∏
                height=2,  # –í—ã—Å–æ—Ç–∞ –∫–Ω–æ–ø–∫–∏
                # –ü—Ä–∏ –∫–ª–∏–∫–µ –≤—ã–∑—ã–≤–∞–µ–º –º–µ—Ç–æ–¥ on_click —Å –Ω—É–∂–Ω—ã–º –∏–Ω–¥–µ–∫—Å–æ–º
                command=lambda idx=i: self.on_click(idx)
            )
            # –†–∞–∑–º–µ—â–∞–µ–º –∫–Ω–æ–ø–∫—É –≤ —Å–µ—Ç–∫–µ(–Ω–æ–º–µ—Ä —Å—Ç—Ä–æ–∫–∏, –Ω–æ–º–µ—Ä —Å—Ç–æ–ª–±—Ü–∞)
            # –†–∞–∑–º–µ—â–∞–µ–º –∫–Ω–æ–ø–∫—É –≤ —Å–µ—Ç–∫–µ, —Ç—É—Ç –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –¥—Ä—É–≥–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
            button.grid(row=i//3, column=i % 3)
            self.buttons.append(button)  # –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –≤ —Å–ø–∏—Å–æ–∫

    def run(self):
        """–ó–∞–ø—É—Å–∫–∞–µ—Ç –≥–ª–∞–≤–Ω–æ–µ –æ–∫–Ω–æ."""
        # –û–∫–Ω–æ —Å –∫–Ω–æ–ø–∫–æ–π "–ù–æ–≤–∞—è –∏–≥—Ä–∞"
        reset_button = tk.Button(self.root, text="–ù–æ–≤–∞—è –∏–≥—Ä–∞", font=(
            "Arial", 14), command=self.reset_game)
        reset_button.grid(row=3, column=0, columnspan=3, sticky="we")
        # –ó–∞–ø—É—Å–∫–∞–µ–º –≥–ª–∞–≤–Ω–æ–µ –æ–∫–Ω–æ
        self.root.mainloop()


if __name__ == '__main__':
    game = TicTacToe()
    # game.create_widgets() –º–æ–∂–Ω–æ —Ä–∞–∑–º–µ–º–µ—Å—Ç–∏—Ç—å –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–µ
    game.run()


"""–ß—Ç–æ –¥–∞–ª—å—à–µ?
–£–ª—É—á—à–∏—Ç—å –∏–≥—Ä—É:

üîπ –ò–≥—Ä–∞ –ø—Ä–æ—Ç–∏–≤ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ üß†
üîπ –°—á—ë—Ç—á–∏–∫ –ø–æ–±–µ–¥ üìä
üîπ –ú–µ–Ω—é –Ω–∞—Å—Ç—Ä–æ–µ–∫ ‚öô
üîπ –ó–≤—É–∫–æ–≤—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã üîä"""